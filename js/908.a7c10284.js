"use strict";(self["webpackChunkchat"]=self["webpackChunkchat"]||[]).push([[908],{4908:function(t,e,s){s.r(e),s.d(e,{default:function(){return et}});var a=s(3396);const n={id:"main"},i={style:{"background-color":"rgb(64 64 64)"},class:"chat",ref:"chat"},o=(0,a._)("div",{style:{"background-color":"#3a3a3a"},class:"author"},[(0,a._)("div",{class:"author-name"},[(0,a.Uk)(" Made by JustRirill (rj_st) "),(0,a._)("br"),(0,a.Uk)(" Github link "),(0,a._)("a",{href:"https://github.com/justririll/JstChat",target:"_blank"},"here"),(0,a.Uk)(),(0,a._)("br"),(0,a.Uk)(" This application is not affiliated with Twitch ")])],-1),r={class:"settings",id:""},l={class:"setting"},h=(0,a._)("div",{class:"setting-name"},"Channel name",-1),c=["value"],d=["onClick"],g={class:"setting"},p=(0,a._)("div",{class:"setting-name"},"Font size",-1),u=["value"],m={class:"setting"},b=(0,a._)("div",{class:"setting-name"},[(0,a.Uk)("Background color "),(0,a._)("br"),(0,a.Uk)(" (in hex; transparent for transparency)")],-1),f=["value"],B={class:"setting"},y=(0,a._)("div",{class:"setting-name"},"7TV paints",-1),v=["value"],G={class:"setting"},_=(0,a._)("div",{class:"setting-name"},[(0,a.Uk)("Make some colors readable "),(0,a._)("br"),(0,a.Uk)(" (only if background not transparent)")],-1),C=["value"],k={class:"setting"},E=(0,a._)("div",{class:"setting-name"},"Border",-1),S=["value"],w=(0,a._)("br",null,null,-1),x=(0,a._)("br",null,null,-1),z={class:"setting",id:"out"},Z=(0,a._)("div",{class:"setting-name"},"Your URL:",-1),P=["value"];function T(t,e,s,T,I,M){const O=(0,a.up)("ChatMessage");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",i,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(I.Messages,(t=>((0,a.wg)(),(0,a.j4)(O,{class:"mes",key:t,Emotes:I.Emotes,Paints:I.Paints,GlobalBadges:I.GlobalBadges,payload:t,BG:I.BG,BG2:I.BG2,paintsEnabled:I.paintsEnabled,font_size:I.fontSize,interpolateSize:I.interpolateSize,OtherBadges:I.OtherBadges,defaultColors:I.defaultColors,SmoothColors:I.SmoothColors,border:I.Border},null,8,["Emotes","Paints","GlobalBadges","payload","BG","BG2","paintsEnabled","font_size","interpolateSize","OtherBadges","defaultColors","SmoothColors","border"])))),128))],512),o,(0,a._)("div",r,[(0,a._)("div",l,[h,(0,a._)("input",{type:"text",value:I.selectedChannel,onInput:e[0]||(e[0]=(...t)=>M.onChangeChannel&&M.onChangeChannel(...t))},null,40,c)]),(0,a._)("button",{onClick:M.join},"Join",8,d),(0,a._)("div",g,[p,(0,a._)("input",{type:"number",value:I.fontSize,max:"50",onInput:e[1]||(e[1]=(...t)=>M.onChangeFontSize&&M.onChangeFontSize(...t))},null,40,u)]),(0,a._)("div",m,[b,(0,a._)("input",{onclick:"this.select();",type:"text",value:I.BG,onInput:e[2]||(e[2]=(...t)=>M.onChangeBG&&M.onChangeBG(...t))},null,40,f)]),(0,a._)("div",B,[y,(0,a._)("input",{class:"checkbox",type:"checkbox",value:I.paintsEnabled,onInput:e[3]||(e[3]=(...t)=>M.onChangePaints&&M.onChangePaints(...t)),checked:""},null,40,v)]),(0,a._)("div",G,[_,(0,a._)("input",{class:"checkbox",type:"checkbox",value:I.SmoothColors,onInput:e[4]||(e[4]=(...t)=>M.onChangeSmooth&&M.onChangeSmooth(...t)),checked:""},null,40,C)]),(0,a._)("div",k,[E,(0,a._)("input",{class:"checkbox",type:"checkbox",value:I.Border,onInput:e[5]||(e[5]=(...t)=>M.onChangeBorder&&M.onChangeBorder(...t)),checked:""},null,40,S)]),w,x,(0,a._)("div",z,[Z,(0,a._)("input",{onclick:"this.select();",class:"out_url",type:"text",value:M.out_url,readonly:""},null,8,P)])])])}var I=s(7139);const M=["bg"],O=["src"],j=["HavePaints"],D=["HavePaints"],F={class:"message-text"},U=["src","ZeroWidth"];function R(t,e,s,n,i,o){return(0,a.wg)(),(0,a.iD)("div",{class:"ChatMessage",bg:s.payload.BG},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.Badges,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:"Badge"},[(0,a._)("img",{src:t.Url},null,8,O)])))),128)),(0,a._)("span",null,[i.displayName.toLowerCase()==this.payload.source.nick?((0,a.wg)(),(0,a.iD)("span",{key:0,HavePaints:i.HavePaints,class:"message-nick",style:(0,I.j5)({color:o.color,backgroundImage:o.bgImage})},(0,I.zw)(i.displayName)+": ",13,j)):(0,a.kq)("",!0),i.displayName.toLowerCase()!=this.payload.source.nick?((0,a.wg)(),(0,a.iD)("span",{key:1,HavePaints:i.HavePaints,class:"message-nick",style:(0,I.j5)({color:o.color,backgroundImage:o.bgImage})},(0,I.zw)(this.payload.source.nick)+" ("+(0,I.zw)(i.displayName)+"): ",13,D)):(0,a.kq)("",!0),(0,a._)("span",F,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.FinalMessage,(t=>((0,a.wg)(),(0,a.iD)(a.HY,{key:t},["emote"==t.Type?((0,a.wg)(),(0,a.iD)("img",{key:0,src:t.Text,ZeroWidth:t.ZeroWidth},null,8,U)):(0,a.kq)("",!0),"text"==t.Type?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Uk)((0,I.zw)(t.Text),1)],64)):(0,a.kq)("",!0)],64)))),128))])])],8,M)}s(2262),s(4506);var $=s(3636),H=s(7167),A=s(9242);const N={name:"ChatMessage",data(){return{EmotesBaseUrl:{"7TV":"https://cdn.7tv.app/emote/{0}/2x.webp",BTTV:"https://cdn.betterttv.net/emote/{0}/2x",FFZ:"https://cdn.frankerfacez.com/emote/{0}/2",TWITCH:""},Paint:null,HavePaints:!1,displayName:"",dot:0,mes_BG:"",Badges:[]}},props:{Emotes:Array,OtherBadges:Array,GlobalBadges:Object,Paints:Array,font_size:String,shadowText:String,paintsEnabled:String,interpolateSize:String,SmoothColors:String,defaultColors:Array,payload:Object,BG:String,BG2:String,border:String},created:async function(){if("PRIVMSG"!=this.payload.command.command)return{};if(this.displayName=this.payload.tags["display-name"],void 0==this.payload.tags["display-name"]&&(this.displayName=this.payload.user),this.payload.tags.badges)for(const[t,e]of Object.entries(this.payload.tags["badges"]))this.GlobalBadges[t]&&this.Badges.push({Url:this.GlobalBadges[t][e]});if(this.OtherBadges)for(const t of this.OtherBadges)t.Users.includes(this.payload.tags["user-id"])&&this.Badges.push({Url:t.Url});if("1"==this.paintsEnabled)for(const t of this.Paints)if(t.users.includes(this.payload.tags["user-id"])){this.HavePaints=!0,this.Paint=t;break}},computed:{color(){let t="0"==this.payload.BG?this.BG:this.BG2,e=this.payload.tags.color;if(this.payload.tags.color||(e=this.defaultColors[Math.floor(Math.random()*this.defaultColors.length)]),"transparent"!=t&&"1"==this.SmoothColors){let s=$.Z.hexToRgb(e),a=$.Z.hexToRgb(t),n=H.Z.rgb2xyz(s[0],s[1],s[2]),i=H.Z.rgb2xyz(a[0],a[1],a[2]),o=10*H.Z.deltaE00(n[0],n[1],n[2],i[0],i[1],i[2]);if(0==o&&(o=1e-4),o<.3){let t=$.Z.pSBC(.25,e);return t}}return e},FinalMessage(){let t=`${this.payload.parameters}`,e=$.Z.textToMessageObject(t);if(this.payload.tags.emotes){let s=$.Z.parse_smiles(t,this.payload.tags["emotes"]);for(const[t,a]of Object.entries(s))for(const s in e)e[s].Text.slice(0,-1)==t&&(e[s].Type="emote",e[s].Text=a,e[s].ZeroWidth=!1)}for(const s of this.Emotes)for(const t in e)e[t].Text.slice(0,-1)==s.Name&&(e[t].Type="emote",e[t].Text=this.EmotesBaseUrl[s.Type].replace("{0}",s.ID),e[t].ZeroWidth=s.ZeroWidth);if(void 0!==this.payload.PersonalEmotes)for(const s of this.payload.PersonalEmotes)for(const t in e)e[t].Text.slice(0,-1)==s.Name&&(e[t].Type="emote",e[t].Text=this.EmotesBaseUrl[s.Type].replace("{0}",s.ID),e[t].ZeroWidth=s.ZeroWidth);return e},bgImage(){if(!this.Paint||"0"==this.paintsEnabled)return"";const t=this.Paint.function,e=[];switch(this.Paint.function){case"linear-gradient":e.push(`${this.Paint.angle}deg`);break;case"radial-graient":e.push(this.Paint.shape??"circle");break;case"url":e.push(this.Paint.image_url??"");break}let s="";"URL"!==this.Paint.function&&(s=this.Paint.repeat?"repeating-":"");for(const a of this.Paint.stops){const t=$.Z.DecimalToStringRGBA(a.color);e.push(`${t} ${100*a.at}%`)}return`${s}${t}(${e.join(", ")})`},filterText(){return"1"==this.shadowText?"drop-shadow(-1px 2px 1px #2b2b2b)":""},filter(){try{if("0"==this.paintsEnabled)throw"paints disabled";return this.Paint.drop_shadows.map((t=>`drop-shadow(${t.x_offset}px ${t.y_offset}px ${t.radius}px ${$.Z.DecimalToStringRGBA(t.color)})`)).join(" ")}catch(t){return"1"==this.shadowText?"drop-shadow(-1px 2px 1px #2b2b2b)":""}},paintColor(){return this.Paint&&"0"!=this.paintsEnabled?$.Z.DecimalToStringRGBA(this.Paint.color):""},badgeSize(){return"1"==this.interpolateSize&&parseInt(this.font_size)?Math.round(.8*parseInt(this.font_size)+4.4).toString()+"px":"18px"},emoteSize(){return"1"==this.interpolateSize&&parseInt(this.font_size)?(parseInt(this.font_size)+14).toString()+"px":"32px"},messageSize(){return this.interpolateSize&&parseInt(this.font_size)?Math.round(1.33*parseInt(this.font_size)+7).toString()+"px":"31px"},Font_Size(){return`${this.font_size}px`},Border(){return`${this.border}px solid black`}}},W=()=>{(0,A.sj)((t=>({af6b0704:t.BG,61051374:t.BG2,"1049202a":t.badgeSize,faf196e2:t.messageSize,d4eef8d0:t.Font_Size,50051005:t.Border,"216b3980":t.emoteSize,e5c7099e:t.filter,"1bfc0644":t.paintColor})))},V=N.setup;N.setup=V?(t,e)=>(W(),V(t,e)):W;var Y=N,L=s(89);const q=(0,L.Z)(Y,[["render",R]]);var J=q,K=s(1852),Q=s(1034),X={name:"main-page",components:{ChatMessage:J},data(){return{paintsEnabled:"1",fontSize:"24",interpolateSize:"1",SmoothColors:"1",Border:"2",altBG:!0,BG:"#2b2b2b",BG2:"",PersonalEmotes:{},GlobalBadges:[],OtherBadges:[],Messages:[],Emotes:[],Badges:{},Paints:[],currBG:!0,channel:"",selectedChannel:"",client:null,evenapi:null,defaultColors:["#4242f7","#ff7f50","#1e90ff","#00ff7f","#9acd32","#008000","#ff4500","#ff0000","#daa520","#ff69b4","#5f9ea0","#2e8b57","#d2691e","#a065d7","#b22222"]}},updated(){this.$refs.chat.scrollTo(0,this.$refs.chat.scrollHeight),this.Messages.length>25&&this.Messages.shift()},created:async function(){if("#2b2b2b"!=this.BG&&"transparent"!=this.BG&&(this.BG="#"+this.BG),this.altBG&&"transparent"!=this.BG){let t=1,e=$.Z.toGray(this.BG);e>.38&&(t=-30/e),this.BG2=$.Z.pSBC(.01*t,this.BG)}else"transparent"==this.BG&&(this.BG2="transparent");await this.create_client()},methods:{onChangeChannel(t){this.selectedChannel=t.target.value.trim().toLowerCase()},onChangeFontSize(t){let e=parseInt(t.target.value.trim());e>0&&e<=50&&(this.fontSize=t.target.value.trim())},onChangeBorder(){this.Border="2"==this.Border.trim()?"0":"2"},onChangeBG(t){let e=t.target.value.trim();if("transparent"==e||"none"==e)this.BG="transparent",this.BG2="transparent";else if(7==e.length&&"#"==e.substring(0,1))try{this.BG=e;let t=1,s=$.Z.toGray(this.BG);s>.38&&(t=-30/s),this.BG2=$.Z.pSBC(.01*t,this.BG)}catch(s){}},onChangePaints(){this.paintsEnabled="1"==this.paintsEnabled.trim()?"0":"1"},onChangeInterpolate(){this.interpolateSize="1"==this.interpolateSize.trim()?"0":"1"},onChangeSmooth(){this.SmoothColors="1"==this.SmoothColors.trim()?"0":"1"},async join(){""!=this.selectedChannel&&this.selectedChannel!=this.channel&&(this.channel=this.selectedChannel,await this.create_client())},async create_client(){this.Emotes=[],this.Messages=[],this.Badges=[],null!=this.client&&this.client.disconnect(),this.client=new K.Z(this.channel),this.client.OnUserId=this.onUserID,this.client.OnPrivateMessage=async t=>{t.BG=0,this.altBG&&(t.BG=this.currBG?0:1,this.currBG=!this.currBG),t.PersonalEmotes=void 0,t.source.nick in this.PersonalEmotes&&(t.PersonalEmotes=this.PersonalEmotes[t.source.nick]),this.Messages.push(t)},this.client.OnClearChat=async t=>{this.Messages=this.Messages.filter((e=>e.source.nick!==t.parameters))},this.client.OnClearMessage=async t=>{this.Messages=this.Messages.filter((e=>e.tags["id"]!==t.tags["target-msg-id"]))};let t=await Q.Z.RetryOnError(Q.Z.getGlobalBadges,[],3);this.GlobalBadges["subscriber"]&&(t["subscriber"]=this.GlobalBadges["subscriber"]),this.GlobalBadges=t;let e=await Q.Z.RetryOnError(Q.Z.get7tvBadgesPaints,[],3);this.OtherBadges=e[0],this.Paints=e[1],""!=this.channel?(this.client.connect(),this.Emotes=this.Emotes.concat(await Q.Z.RetryOnError(Q.Z.get7tvGlobalEmotes,[],3)),console.log("loaded 7tv global emotes"),this.Emotes=this.Emotes.concat(await Q.Z.RetryOnError(Q.Z.getBttvGlobalEmotes,[],3)),console.log("loaded bttv global emotes"),this.Emotes=this.Emotes.concat(await Q.Z.RetryOnError(Q.Z.getFfzEmotes,[this.channel],3)),console.log("loaded ffz channel emotes"),this.Emotes=this.Emotes.concat(await Q.Z.RetryOnError(Q.Z.getFfzGlobalEmotes,[],3)),console.log("loaded ffz global emotes")):(this.Emotes=this.Emotes.concat(await Q.Z.RetryOnError(Q.Z.get7tvGlobalEmotes,[],3)),this.Messages.push({tags:{"badge-info":null,badges:{"game-developer":"1"},color:"#FFFFFF","display-name":"rj_st",emotes:null,"first-msg":"0",id:"4e9b10fb-7e80-46b5-9652-efc894188334",mod:"0","returning-chatter":"0","room-id":"22484632",subscriber:"0","tmi-sent-ts":"1680165804876",turbo:"0","user-id":"407046453","user-type":null},source:{nick:"rj_st",host:"rj_st@rj_st.tmi.twitch.tv"},command:{command:"PRIVMSG",channel:"#forsen"},parameters:"ApuApustaja TeaTime",BG:"0"}),this.Messages.push({tags:{"badge-info":null,badges:{"game-developer":"1"},color:"#FFFFFF","display-name":"rj_st",emotes:null,"first-msg":"0",id:"4e9b10fb-7e80-46b5-9652-efc894188334",mod:"0","returning-chatter":"0","room-id":"22484632",subscriber:"0","tmi-sent-ts":"1680165804876",turbo:"0","user-id":"407046453","user-type":null},source:{nick:"rj_st",host:"rj_st@rj_st.tmi.twitch.tv"},command:{command:"PRIVMSG",channel:"#forsen"},parameters:"ApuApustaja TeaTime",BG:"1"}))},async get7tvchannel(){let t=await Q.Z.RetryOnError(Q.Z.get7tvEmotes,[this.channelID],3);t.length>0&&(console.log("loaded seventv channel"),this.Emotes=this.Emotes.concat(t[0]))},async getbttvchannel(){this.Emotes=this.Emotes.concat(await await Q.Z.RetryOnError(Q.Z.getBttvEmotes,[this.channelID],3))},async getsubscriberbadges(){let t=await Q.Z.RetryOnError(Q.Z.getSubscriberBadges,[this.channelID],3);t&&(this.GlobalBadges["subscriber"]=t,console.log("loaded sub badges"))},async onUserID(t){console.log(this.channelID),null==this.channelID&&(this.channelID=t,await this.getbttvchannel(),await this.get7tvchannel(),await this.getsubscriberbadges())}},computed:{out_url(){let t="";return""!=this.selectedChannel?(18!=this.fontSize&&(t+=`&font_size=${this.fontSize}`),"#2b2b2b"!=this.BG&&(t+=`&background=${"transparent"!=this.BG?this.BG.substring(1):this.BG}`),"1"!=this.paintsEnabled&&(t+="&paints=0"),"1"!=this.SmoothColors&&(t+="&smoothcolor=0"),"2"!=this.Border&&(t+="&border=0"),`${location.toString()}chat?channel=${this.selectedChannel}${t}`):"No channel!"}}};const tt=(0,L.Z)(X,[["render",T]]);var et=tt}}]);
//# sourceMappingURL=908.a7c10284.js.map