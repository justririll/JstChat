"use strict";(self["webpackChunkchat"]=self["webpackChunkchat"]||[]).push([[73],{8073:function(t,e,s){s.r(e),s.d(e,{default:function(){return ut}});var a=s(3396);const n={id:"main"},i={style:{"background-color":"rgb(64 64 64)"},class:"chat",ref:"chat"},o=(0,a._)("div",{style:{"background-color":"#3a3a3a"},class:"author"},[(0,a._)("div",{class:"author-name"},[(0,a.Uk)(" Made by JustRirill (rj_st) "),(0,a._)("br"),(0,a.Uk)(" Github link "),(0,a._)("a",{href:"https://github.com/justririll/JstChat",target:"_blank"},"here"),(0,a.Uk)(),(0,a._)("br"),(0,a.Uk)(" This application is not affiliated with Twitch ")])],-1),r={class:"settings"},l={class:"setting",id:"channel-select"},h=(0,a._)("div",{class:"setting-name"},"Channel name",-1),c=["value"],d=["onClick"],g=(0,a._)("br",null,null,-1),p={class:"setting",id:"style-select"},u=(0,a._)("div",{class:"setting-name"},"Style",-1),m=(0,a._)("option",{value:"1"},"1",-1),b=(0,a._)("option",{value:"2"},"2",-1),f=[m,b],B=(0,a._)("br",null,null,-1),y={class:"setting"},v=(0,a._)("div",{class:"setting-name"},"Font size",-1),_=["value"],G={class:"setting"},C=(0,a._)("div",{class:"setting-name"},[(0,a.Uk)("Background color "),(0,a._)("br"),(0,a.Uk)(" (in hex)")],-1),k=["value"],E={class:"setting"},S=(0,a._)("div",{class:"setting-name"},"7TV paints",-1),w=["value"],x={class:"setting"},z=(0,a._)("div",{class:"setting-name"},[(0,a.Uk)("Make some colors readable "),(0,a._)("br"),(0,a.Uk)(" (only if background not transparent)")],-1),Z=["value"],P={class:"setting"},T=(0,a._)("div",{class:"setting-name"},"Border",-1),I=["value"],M={class:"setting"},O=(0,a._)("div",{class:"setting-name"},[(0,a.Uk)("7TV personal emotes "),(0,a._)("br"),(0,a.Uk)(" (will not work without eventapi)")],-1),j=["value"],D={class:"setting"},F=(0,a._)("div",{class:"setting-name"},"7TV event api",-1),U=["value"],R=(0,a._)("br",null,null,-1),$=(0,a._)("br",null,null,-1),A={class:"setting",id:"out"},H=(0,a._)("div",{class:"setting-name"},"Your URL:",-1),N=["value"];function W(t,e,s,m,b,W){const V=(0,a.up)("ChatMessage");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",i,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.Messages,(t=>((0,a.wg)(),(0,a.j4)(V,{class:"mes",key:t,Emotes:b.Emotes,Paints:b.Paints,GlobalBadges:b.GlobalBadges,payload:t,BG:b.BG,BG2:b.BG2,paintsEnabled:b.paintsEnabled,font_size:b.fontSize,interpolateSize:b.interpolateSize,OtherBadges:b.OtherBadges,defaultColors:b.defaultColors,SmoothColors:b.SmoothColors,border:b.Border,shadowText:b.textShadow},null,8,["Emotes","Paints","GlobalBadges","payload","BG","BG2","paintsEnabled","font_size","interpolateSize","OtherBadges","defaultColors","SmoothColors","border","shadowText"])))),128))],512),o,(0,a._)("div",r,[(0,a._)("div",l,[h,(0,a._)("input",{type:"text",value:b.selectedChannel,onInput:e[0]||(e[0]=(...t)=>W.onChangeChannel&&W.onChangeChannel(...t))},null,40,c)]),(0,a._)("button",{onClick:W.join},"Join",8,d),g,(0,a._)("div",p,[u,(0,a._)("select",{onChange:e[1]||(e[1]=(...t)=>W.changeStyle&&W.changeStyle(...t))},f,32)]),B,(0,a._)("div",y,[v,(0,a._)("input",{type:"number",value:b.fontSize,min:"4",max:"50",onInput:e[2]||(e[2]=(...t)=>W.onChangeFontSize&&W.onChangeFontSize(...t))},null,40,_)]),(0,a._)("div",G,[C,(0,a._)("input",{onclick:"this.select();",type:"text",value:b.BG,onInput:e[3]||(e[3]=(...t)=>W.onChangeBG&&W.onChangeBG(...t))},null,40,k)]),(0,a._)("div",E,[S,(0,a._)("input",{class:"checkbox",type:"checkbox",value:b.paintsEnabled,onInput:e[4]||(e[4]=(...t)=>W.onChangePaints&&W.onChangePaints(...t)),checked:""},null,40,w)]),(0,a._)("div",x,[z,(0,a._)("input",{class:"checkbox",type:"checkbox",value:b.SmoothColors,onInput:e[5]||(e[5]=(...t)=>W.onChangeSmooth&&W.onChangeSmooth(...t)),checked:""},null,40,Z)]),(0,a._)("div",P,[T,(0,a._)("input",{class:"checkbox",type:"checkbox",value:b.Border,onInput:e[6]||(e[6]=(...t)=>W.onChangeBorder&&W.onChangeBorder(...t)),checked:""},null,40,I)]),(0,a._)("div",M,[O,(0,a._)("input",{class:"checkbox",type:"checkbox",value:b.pEmotes,onInput:e[7]||(e[7]=(...t)=>W.onChangepEmotes&&W.onChangepEmotes(...t)),checked:""},null,40,j)]),(0,a._)("div",D,[F,(0,a._)("input",{class:"checkbox",type:"checkbox",value:b.eventApi,onInput:e[8]||(e[8]=(...t)=>W.onChangeEventApi&&W.onChangeEventApi(...t)),checked:""},null,40,U)]),R,$,(0,a._)("div",A,[H,(0,a._)("input",{onclick:"this.select();",class:"out_url",type:"text",value:W.out_url,readonly:""},null,8,N)])])])}var V=s(7139);const Y=["bg"],L=["src"],q=["HavePaints"],J=["HavePaints"],K={class:"message-text"},Q=["src","ZeroWidth"];function X(t,e,s,n,i,o){return(0,a.wg)(),(0,a.iD)("div",{class:"ChatMessage",bg:s.payload.BG},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.Badges,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:"Badge"},[(0,a._)("img",{src:t.Url},null,8,L)])))),128)),(0,a._)("span",null,[i.displayName.toLowerCase()==this.payload.source.nick?((0,a.wg)(),(0,a.iD)("span",{key:0,HavePaints:i.HavePaints,class:"message-nick",style:(0,V.j5)({color:o.color,backgroundImage:o.bgImage})},(0,V.zw)(i.displayName)+": ",13,q)):(0,a.kq)("",!0),i.displayName.toLowerCase()!=this.payload.source.nick?((0,a.wg)(),(0,a.iD)("span",{key:1,HavePaints:i.HavePaints,class:"message-nick",style:(0,V.j5)({color:o.color,backgroundImage:o.bgImage})},(0,V.zw)(this.payload.source.nick)+" ("+(0,V.zw)(i.displayName)+"): ",13,J)):(0,a.kq)("",!0),(0,a._)("span",K,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.FinalMessage,(t=>((0,a.wg)(),(0,a.iD)(a.HY,{key:t},["emote"==t.Type?((0,a.wg)(),(0,a.iD)("img",{key:0,src:t.Text,ZeroWidth:t.ZeroWidth},null,8,Q)):(0,a.kq)("",!0),"text"==t.Type?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Uk)((0,V.zw)(t.Text),1)],64)):(0,a.kq)("",!0)],64)))),128))])])],8,Y)}s(2262),s(4506);var tt=s(3636),et=s(7167),st=s(9242);const at={name:"ChatMessage",data(){return{EmotesBaseUrl:{"7TV":"https://cdn.7tv.app/emote/{0}/2x.webp",BTTV:"https://cdn.betterttv.net/emote/{0}/2x",FFZ:"https://cdn.frankerfacez.com/emote/{0}/2",TWITCH:""},Paint:null,HavePaints:!1,displayName:"",dot:0,mes_BG:"",Badges:[]}},props:{Emotes:Array,OtherBadges:Array,GlobalBadges:Object,Paints:Array,font_size:String,shadowText:String,paintsEnabled:String,interpolateSize:String,SmoothColors:String,defaultColors:Array,payload:Object,BG:String,BG2:String,border:String},created:async function(){if("PRIVMSG"!=this.payload.command.command)return{};if(this.displayName=this.payload.tags["display-name"],void 0==this.payload.tags["display-name"]&&(this.displayName=this.payload.user),this.payload.tags.badges)for(const[t,e]of Object.entries(this.payload.tags["badges"]))this.GlobalBadges[t]&&this.Badges.push({Url:this.GlobalBadges[t][e]});if(this.OtherBadges)for(const t of this.OtherBadges)t.Users.includes(this.payload.tags["user-id"])&&this.Badges.push({Url:t.Url});if("1"==this.paintsEnabled)for(const t of this.Paints)if(t.users.includes(this.payload.tags["user-id"])){this.HavePaints=!0,this.Paint=t;break}},computed:{color(){let t="0"==this.payload.BG?this.BG:this.BG2,e=this.payload.tags.color;if(this.payload.tags.color||(e=this.defaultColors[Math.floor(Math.random()*this.defaultColors.length)]),"transparent"!=t&&"1"==this.SmoothColors){let s=tt.Z.hexToRgb(e),a=tt.Z.hexToRgb(t),n=et.Z.rgb2xyz(s[0],s[1],s[2]),i=et.Z.rgb2xyz(a[0],a[1],a[2]),o=10*et.Z.deltaE00(n[0],n[1],n[2],i[0],i[1],i[2]);if(0==o&&(o=1e-4),o<.3){let t=tt.Z.pSBC(.25,e);return t}}return e},FinalMessage(){let t=`${this.payload.parameters}`,e=tt.Z.textToMessageObject(t);if(this.payload.tags.emotes){let s=tt.Z.parse_smiles(t,this.payload.tags["emotes"]);for(const[t,a]of Object.entries(s))for(const s in e)e[s].Text.slice(0,-1)==t&&(e[s].Type="emote",e[s].Text=a,e[s].ZeroWidth=!1)}for(const s of this.Emotes)for(const t in e)e[t].Text.slice(0,-1)==s.Name&&(e[t].Type="emote",e[t].Text=this.EmotesBaseUrl[s.Type].replace("{0}",s.ID),e[t].ZeroWidth=s.ZeroWidth);if(void 0!==this.payload.PersonalEmotes)for(const s of this.payload.PersonalEmotes)for(const t in e)e[t].Text.slice(0,-1)==s.Name&&(e[t].Type="emote",e[t].Text=this.EmotesBaseUrl[s.Type].replace("{0}",s.ID),e[t].ZeroWidth=s.ZeroWidth);return e},bgImage(){if(!this.Paint||"0"==this.paintsEnabled)return"";const t=this.Paint.function,e=[];switch(this.Paint.function){case"linear-gradient":e.push(`${this.Paint.angle}deg`);break;case"radial-graient":e.push(this.Paint.shape??"circle");break;case"url":e.push(this.Paint.image_url??"");break}let s="";"URL"!==this.Paint.function&&(s=this.Paint.repeat?"repeating-":"");for(const a of this.Paint.stops){const t=tt.Z.DecimalToStringRGBA(a.color);e.push(`${t} ${100*a.at}%`)}return`${s}${t}(${e.join(", ")})`},filterText(){return"1"==this.shadowText?"drop-shadow(-1px 2px 1px #2b2b2b)":""},filter(){try{if("0"==this.paintsEnabled)throw"paints disabled";return this.Paint.drop_shadows.map((t=>`drop-shadow(${t.x_offset}px ${t.y_offset}px ${t.radius}px ${tt.Z.DecimalToStringRGBA(t.color)})`)).join(" ")}catch(t){return"1"==this.shadowText?"drop-shadow(-1px 2px 1px #2b2b2b)":""}},paintColor(){return this.Paint&&"0"!=this.paintsEnabled?tt.Z.DecimalToStringRGBA(this.Paint.color):""},badgeSize(){return"1"==this.interpolateSize&&parseInt(this.font_size)?Math.round(.8*parseInt(this.font_size)+4.4).toString()+"px":"18px"},emoteSize(){return"1"==this.interpolateSize&&parseInt(this.font_size)?(parseInt(this.font_size)+14).toString()+"px":"32px"},messageSize(){return this.interpolateSize&&parseInt(this.font_size)?Math.round(1.33*parseInt(this.font_size)+7).toString()+"px":"31px"},Font_Size(){return`${this.font_size}px`},Border(){return`${this.border}px solid black`}}},nt=()=>{(0,st.sj)((t=>({"4706496b":t.BG,cc7a37b2:t.BG2,"080ea344":t.badgeSize,"1762bb7c":t.messageSize,ccb47bea:t.Font_Size,"61069e72":t.Border,"3268782a":t.filterText,"1930bc9a":t.emoteSize,c3c3ecc4:t.filter,"718c8ccb":t.paintColor})))},it=at.setup;at.setup=it?(t,e)=>(nt(),it(t,e)):nt;var ot=at,rt=s(89);const lt=(0,rt.Z)(ot,[["render",X]]);var ht=lt,ct=s(1852),dt=s(1034),gt={name:"main-page",components:{ChatMessage:ht},data(){return{paintsEnabled:"1",fontSize:"18",interpolateSize:"1",SmoothColors:"1",Border:"2",pEmotes:"1",eventApi:"1",textShadow:"0",altBG:!0,BG:"#2b2b2b",BG2:"",PersonalEmotes:{},GlobalBadges:[],OtherBadges:[],Messages:[],Emotes:[],Badges:{},Paints:[],currBG:!0,channel:"",selectedChannel:"",client:null,evenapi:null,defaultColors:["#4242f7","#ff7f50","#1e90ff","#00ff7f","#9acd32","#008000","#ff4500","#ff0000","#daa520","#ff69b4","#5f9ea0","#2e8b57","#d2691e","#a065d7","#b22222"]}},updated(){this.$refs.chat.scrollTo(0,this.$refs.chat.scrollHeight),this.Messages.length>25&&this.Messages.shift()},created:async function(){if("#2b2b2b"!=this.BG&&"transparent"!=this.BG&&(this.BG="#"+this.BG),this.altBG&&"transparent"!=this.BG){let t=1,e=tt.Z.toGray(this.BG);e>.38&&(t=-30/e),this.BG2=tt.Z.pSBC(.01*t,this.BG)}else"transparent"==this.BG&&(this.BG2="transparent");await this.create_client()},methods:{changeStyle(t){switch(t.target.value.trim()){case"1":this.Border="2",this.BG="#2b2b2b",this.BG2="#323232",this.SmoothColors="1",this.textShadow="0";break;case"2":this.Border="0",this.BG="transparent",this.BG2="transparent",this.SmoothColors="0",this.textShadow="1";break}},onChangeChannel(t){this.selectedChannel=t.target.value.trim().toLowerCase()},onChangeFontSize(t){let e=parseInt(t.target.value.trim());e>0&&e<=50&&(this.fontSize=t.target.value.trim())},onChangepEmotes(){this.pEmotes="1"==this.pEmotes.trim()?"0":"1"},onChangeBorder(){this.Border="2"==this.Border.trim()?"0":"2"},onChangeBG(t){let e=t.target.value.trim();if("transparent"==e||"none"==e||""==e)this.BG="transparent",this.BG2="transparent";else if(7==e.length&&"#"==e.substring(0,1))try{this.BG=e;let t=1,s=tt.Z.toGray(this.BG);s>.38&&(t=-30/s),this.BG2=tt.Z.pSBC(.01*t,this.BG)}catch(s){}},onChangePaints(){this.paintsEnabled="1"==this.paintsEnabled.trim()?"0":"1"},onChangeInterpolate(){this.interpolateSize="1"==this.interpolateSize.trim()?"0":"1"},onChangeSmooth(){this.SmoothColors="1"==this.SmoothColors.trim()?"0":"1"},onChangeEventApi(){this.eventApi="1"==this.eventApi.trim()?"0":"1"},async join(){""!=this.selectedChannel&&this.selectedChannel!=this.channel&&(this.channel=this.selectedChannel,await this.create_client())},async create_client(){this.Emotes=[],this.Messages=[],this.Badges=[],null!=this.client&&this.client.disconnect(),this.channelID=null,this.client=new ct.Z(this.channel),this.client.OnUserId=this.onUserID,this.client.OnPrivateMessage=async t=>{t.BG=0,this.altBG&&(t.BG=this.currBG?0:1,this.currBG=!this.currBG),t.PersonalEmotes=void 0,t.source.nick in this.PersonalEmotes&&(t.PersonalEmotes=this.PersonalEmotes[t.source.nick]),this.Messages.push(t)},this.client.OnClearChat=async t=>{this.Messages=this.Messages.filter((e=>e.source.nick!==t.parameters))},this.client.OnClearMessage=async t=>{this.Messages=this.Messages.filter((e=>e.tags["id"]!==t.tags["target-msg-id"]))};let t=await dt.Z.RetryOnError(dt.Z.getGlobalBadges,[],3);this.GlobalBadges["subscriber"]&&(t["subscriber"]=this.GlobalBadges["subscriber"]),this.GlobalBadges=t;let e=await dt.Z.RetryOnError(dt.Z.get7tvBadgesPaints,[],3);this.OtherBadges=e[0],this.Paints=e[1],""!=this.channel?(this.client.connect(),this.Emotes=this.Emotes.concat(await dt.Z.RetryOnError(dt.Z.get7tvGlobalEmotes,[],3)),console.log("loaded 7tv global emotes"),this.Emotes=this.Emotes.concat(await dt.Z.RetryOnError(dt.Z.getBttvGlobalEmotes,[],3)),console.log("loaded bttv global emotes"),this.Emotes=this.Emotes.concat(await dt.Z.RetryOnError(dt.Z.getFfzEmotes,[this.channel],3)),console.log("loaded ffz channel emotes"),this.Emotes=this.Emotes.concat(await dt.Z.RetryOnError(dt.Z.getFfzGlobalEmotes,[],3)),console.log("loaded ffz global emotes")):(this.Emotes=this.Emotes.concat(await dt.Z.RetryOnError(dt.Z.get7tvGlobalEmotes,[],3)),this.Messages.push({tags:{"badge-info":null,badges:{"game-developer":"1"},color:"#FFFFFF","display-name":"rj_st",emotes:null,"first-msg":"0",id:"4e9b10fb-7e80-46b5-9652-efc894188334",mod:"0","returning-chatter":"0","room-id":"22484632",subscriber:"0","tmi-sent-ts":"1680165804876",turbo:"0","user-id":"407046453","user-type":null},source:{nick:"rj_st",host:"rj_st@rj_st.tmi.twitch.tv"},command:{command:"PRIVMSG",channel:"#forsen"},parameters:"ApuApustaja TeaTime",BG:"0"}),this.Messages.push({tags:{"badge-info":null,badges:{"game-developer":"1"},color:"#FFFFFF","display-name":"rj_st",emotes:null,"first-msg":"0",id:"4e9b10fb-7e80-46b5-9652-efc894188334",mod:"0","returning-chatter":"0","room-id":"22484632",subscriber:"0","tmi-sent-ts":"1680165804876",turbo:"0","user-id":"407046453","user-type":null},source:{nick:"rj_st",host:"rj_st@rj_st.tmi.twitch.tv"},command:{command:"PRIVMSG",channel:"#forsen"},parameters:"ApuApustaja TeaTime",BG:"1"}))},async get7tvchannel(){let t=await dt.Z.RetryOnError(dt.Z.get7tvEmotes,[this.channelID],3);t.length>0&&(console.log("loaded seventv channel"),this.Emotes=this.Emotes.concat(t[0]))},async getbttvchannel(){this.Emotes=this.Emotes.concat(await await dt.Z.RetryOnError(dt.Z.getBttvEmotes,[this.channelID],3))},async getsubscriberbadges(){let t=await dt.Z.RetryOnError(dt.Z.getSubscriberBadges,[this.channelID],3);t&&(this.GlobalBadges["subscriber"]=t,console.log("loaded sub badges"))},async onUserID(t){console.log(this.channelID),null==this.channelID&&(this.channelID=t,await this.getbttvchannel(),await this.get7tvchannel(),await this.getsubscriberbadges())}},computed:{out_url(){let t="";return""!=this.selectedChannel?(18!=this.fontSize&&(t+=`&font_size=${this.fontSize}`),"#2b2b2b"!=this.BG&&(t+=`&background=${"transparent"!=this.BG?this.BG.substring(1):this.BG}`),"1"!=this.paintsEnabled&&(t+="&paints=0"),"1"!=this.SmoothColors&&(t+="&smoothcolor=0"),"2"!=this.Border&&(t+="&border=0"),"1"!=this.pEmotes&&(t+="&pemotes=0"),"1"!=this.eventApi&&(t+="&eventapi=0"),"0"!=this.textShadow&&(t+="&shadowtext=1"),`${location.toString()}chat?channel=${this.selectedChannel}${t}`):"No channel!"}}};const pt=(0,rt.Z)(gt,[["render",W]]);var ut=pt}}]);
//# sourceMappingURL=73.5dbdb805.js.map